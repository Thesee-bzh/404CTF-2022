# Crypto / Un RSA incassable

## Challenge
Bonjour Agent,

Nous avons appris que Hallebarde utilisait le chiffrement RSA pour communiquer! Nous avons pu intercepter un de leur message ci-dessous, ainsi que la clé publique utilisée. Selon nos experts qui sont passés avant, "Le module est trop gros, on ne peut rien faire". Pouvez-vous voir s'ils ont raté quelque chose?

## Inputs
The public key and an encrypted message:
```
Module: 264260849184973464982616810011189432725471679851535970549752992980013685427054130834600835230399904802462965456974947538318213223585436360002292504595152950137188712696208597449140460215140901426523911789537180980494972189978839047835537352914856104135490608512555869141766081593589643441958443651294711541856201978508340915671607277979591968248058399795168563294090427290234733756922544755667413890558324220843460177193246018531280862561066074120654752753002311679435459237771670352371010596105395795940209523309781850979927988566194373203050532192192865140293356042897510103979797577385050030819647066037181
Exposant: 65537
Message chiffré: 40110232492214007673187408092050413824057587648366839143339482691859337096033351102276645395275735274322548715598894335826499267358923539936373981416212599523632227239475760261528220077888121552688286380591552417803111794635687206274867498165659330678667435332328065173075710535404048653621228158847748005294255562046654937629633514846123655978199420228460405580305729253303227936760801772396770804796700223239015341586701669475537453700175448572495847377417335800300005252499067811919833639526361733535793115856365357616339193637149185654816751038389408567777725988888990153670326115611236718811592564298263
```

## Solution
Let's search the modulus in [factordb](http://factordb.com), to see if we can find the factorization of the public key. Not only does it find it, but the public key can be factorized in multiple prime numbers (64 to be precise):
```
2642608491...81<609> = 2155535293<10> · 2199478601<10> · 2295459937<10> · 2322429719<10> · 2339050229<10> · 2379443669<10> · 2389392361<10> · 2436205657<10> · 2462984113<10> · 2516886503<10> · 2547151627<10> · 2635311961<10> · 2686629157<10> · 2738125309<10> · 2778293267<10> · 2778911501<10> · 2800829821<10> · 2879122817<10> · 2880934613<10> · 2886660797<10> · 2898630157<10> · 2900891821<10> · 2908514743<10> · 2911937201<10> · 2917907323<10> · 2952780151<10> · 2966345311<10> · 3103669319<10> · 3103875457<10> · 3132223999<10> · 3166178749<10> · 3184079849<10> · 3206428061<10> · 3222160589<10> · 3223685581<10> · 3232212233<10> · 3356051399<10> · 3426525181<10> · 3560494649<10> · 3563338969<10> · 3581219329<10> · 3585015977<10> · 3667357531<10> · 3706613399<10> · 3729776389<10> · 3806038133<10> · 3837412127<10> · 3867368123<10> · 3889812197<10> · 3892296953<10> · 3921428509<10> · 3939808331<10> · 3976581139<10> · 4023565787<10> · 4103248031<10> · 4106593759<10> · 4157125969<10> · 4168849637<10> · 4191669737<10> · 4236657239<10> · 4242244397<10> · 4249725811<10> · 4254782471<10> · 4277613239<10>
```

So we have a multi prime RSA public key: that's not good...

Here is a python script that solves multi prime RSA given the modulus, e and a ciphered message: [Multi prime RSA](https://gist.github.com/jackz314/09cf253d3451f169c2dbb6bbfed73782). The maths behind it is given here: [RSA encryption and decryption with multi prime modulus using CRT](https://crypto.stackexchange.com/questions/31109/rsa-enc-decryption-with-multiple-prime-modulus-using-crt)

We simply pull that python script `multi_prime_rsa.py`, change (n, e, c) and also provides the list of prime numbers from [factordb](http://factordb.com):
```python
# From http://factordb.com, we can factorize n: it has 64 prime numbers !
primes = [ 2155535293, 2199478601, 2295459937, 2322429719, 2339050229, 2379443669, 2389392361, 2436205657, 2462984113, 2516886503, 2547151627, 2635311961, 2686629157, 2738125309, 2778293267, 2778911501, 2800829821, 2879122817, 2880934613, 2886660797, 2898630157, 2900891821, 2908514743, 2911937201, 2917907323, 2952780151, 2966345311, 3103669319, 3103875457, 3132223999, 3166178749, 3184079849, 3206428061, 3222160589, 3223685581, 3232212233, 3356051399, 3426525181, 3560494649, 3563338969, 3581219329, 3585015977, 3667357531, 3706613399, 3729776389, 3806038133, 3837412127, 3867368123, 3889812197, 3892296953, 3921428509, 3939808331, 3976581139, 4023565787, 4103248031, 4106593759, 4157125969, 4168849637, 4191669737, 4236657239, 4242244397, 4249725811, 4254782471, 4277613239 ]
```

```console
$ python3 multi_prime_rsa.py
404CTF{F41t35_4tt3t10n5_4v3c_l3_R54}
```

## Python code
Complete solution in [multi_prime_rsa.py](./multi_prime_rsa.py)

## Flag
404CTF{F41t35_4tt3t10n5_4v3c_l3_R54}
